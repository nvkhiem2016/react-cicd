name: Deploy to Production

on:
  push:
    branches:
      - main
    paths:
      - "**.jsx"
      - "**.json"
      - "**.ts"
      - "**.yml"
  pull_request:
    branches:
      - main
    types: [closed, opened]

# env:
#   AWS_S3_BUCKET: ${{secrets.AWS_S3_BUCKET}}
#   AWS_S3_REGION: ${{secrets.AWS_S3_REGION}}

jobs:
  install_package:
    runs-on: ubuntu-latest
    steps:
      - run: echo install_package!!!

  unit-test:
    runs-on: ubuntu-latest
    needs: [install_package]
    steps:
      - run: echo Unit Test!!!
  automation-test:
    runs-on: ubuntu-latest
    needs: [install_package]
    steps:
      - run: echo Automation Test!!!

  deploy-production:
    runs-on: ubuntu-latest
    needs: [install_package, unit-test, automation-test]
    environment: production
    name: "Deploy production"
    if: github.event.pull_request.merged == 'true'
    steps:
      - run: echo Deploy production
